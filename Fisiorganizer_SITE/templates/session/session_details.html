
{% extends "layout.html" %}
{% load widget_tweaks %}
{% load static %}
{% block content %}

<h1 class="text-center">Detalhes da sessão</h1>


<div class="col-sm-2"></div>
<div class="col-md-8">
    <hr>
    <table class="table table-striped">

        <tbody>
        {% for key, value in session_dto %}
        <tr>
            <td>
                {{ key }}
            </td>
            <td>
                {{ value }}
            </td>
        </tr>
        {% endfor %}

        </tbody>
    </table>
    <hr>


    <h3 class="text-center">Exercícios da Sessão</h3>
        <table class="table table-striped">
        <thead>
        <th>Exercício</th>
        <th>Nível</th>
        <th>Ações<th>
        
        </thead>      
            {% for exercise in session_exercises_dto %}
        <tbody>  
        <tr>
            <td>
                {{ exercise.exercise_name }}
            </td>
            <td>
                {{ exercise.level }}
            </td>
            <td>
                <a href="#" class="" role="button">
                    <span class="glyphicon glyphicon-info-sign" aria-hidden="true">&nbsp;</span>Detalhes
                </a>
                <span>&nbsp;</span>

                <a href="#" class="" role="button">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true">&nbsp;</span>Editar
                </a>

                <span>&nbsp;</span>

                <a class="" role="button" name="delete" id-exercise="{{ exercise.id_exercise }}" id-session-exercise="{{exercise.id}}">
                    <span class="glyphicon glyphicon-remove-circle" aria-hidden="true">&nbsp;</span>Excluir
                </a>
            </td>
        </tr>

        </tbody>
    {% endfor %}
    </table>    
    
    <a href="javascript:history.go(-1)" class="btn btn-default" role="button">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true">&nbsp;</span>Voltar
    </a>

    <a href="#" name="add_exercise" class="btn btn-primary" role="button">
        <span class="glyphicon glyphicon-plus" aria-hidden="true">&nbsp;</span>Adicionar
    </a>
    </div>
<div class="col-sm-2"></div>

<script type="text/javascript">
    $(document).ready(function() {
        bootbox.setDefaults({
            locale: "br"
        });
    });

        $('[name="add_exercise"]').click(function(e) {
            bootbox.prompt({
                size: "medium",
                title: "Selecione o exercício",
                inputType: 'select',
                inputOptions: [
                    {% for exercise in exercises_dto %}
                    {
                        text: "{{ exercise.name}}",
                        value: {{exercise.id}}
                    },
                    {% endfor %}
                ],

                callback: function(result){

                    $.post("{% url 'add_session_exercise' id=session_id %}", {
                        id_exercise: result,
                        csrfmiddlewaretoken: "{{ csrf_token }}"
                        });

                    location.reload();
                    
                }
            });
        });

            $('[name="delete"]').click(function(e) {
        var botaoClicado = $(this);
        var id_exercise = botaoClicado.attr("id-exercise");
        var id_session_exercise = botaoClicado.attr("id-session-exercise");
        bootbox.confirm({
            size: "medium",
            message: "Deseja realmente excluir?",
            callback: function(result) {

                if(result){
                    $.post("{% url 'delete_session_exercise' id=session_id %}", 
                    {
                        id_exercise: id_exercise,
                        id_session_exercise: id_session_exercise,
                        csrfmiddlewaretoken: "{{ csrf_token }}"
                    }, 
                    function() {
                        location.reload();
                    });
                }  
            }
        });
    });

            
</script>
  


{% endblock %}